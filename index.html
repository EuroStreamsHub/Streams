<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EuroStreamHub - Live Today</title>
<style>
body {
  margin:0;
  font-family:'Segoe UI',Roboto,sans-serif;
  background:#121212;
  color:#f1faee;
}
header {
  background:#0a3d62;
  color:white;
  padding:0.5rem 1rem;
  position:sticky;
  top:0;
  z-index:1000;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
header h1 {
  font-size:1.5rem;
}
#matches {
  margin:1rem auto;
  max-width:800px;
}
.match-link {
  display:flex;
  align-items:center;
  justify-content:space-between;
  background:#1f1f1f;
  color:#f1faee;
  text-decoration:none;
  padding:0.5rem 1rem;
  margin:0.3rem 0;
  border-radius:5px;
  transition:0.2s;
}
.match-link:hover { background:#0a3d62; }
.match-link span { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.live-badge {
  background:#ff6700;
  color:white;
  font-weight:bold;
  font-size:0.75rem;
  padding:0 0.3rem;
  border-radius:0.2rem;
  margin-left:0.5rem;
}
</style>
</head>
<body>

<header>
  <h1>EuroStreamHub</h1>
</header>

<div id="matches"></div>

<script>
const API_BASE = "https://streamed.pk/api";
const matchesDiv = document.getElementById("matches");
const now = Date.now();

// Fetch all sports
async function fetchSports() {
  try {
    const res = await fetch(`${API_BASE}/sports`);
    return await res.json();
  } catch(e) { console.error("Sports fetch error:", e); return []; }
}

// Fetch matches for a sport
async function fetchMatchesForSport(sportId) {
  try {
    const res = await fetch(`${API_BASE}/matches/${sportId}`);
    const data = await res.json();
    return Array.isArray(data) ? data : (data.matches || []);
  } catch(e) { console.error("Matches fetch error:", e); return []; }
}

// Filter matches for today
function filterToday(matches) {
  const today = new Date();
  today.setHours(0,0,0,0);
  const tomorrow = new Date(today);
  tomorrow.setDate(today.getDate()+1);
  return matches.filter(m => {
    const d = new Date(m.date);
    return d >= today && d < tomorrow;
  });
}

// Render matches in Streameast-style bars
function renderMatches(matches) {
  matchesDiv.innerHTML = "";
  matches.forEach(m => {
    const a = document.createElement("a");
    a.href = m.streams?.[0]?.url || "#";
    a.className = "match-link";

    // Sport label
    const sportSpan = document.createElement("span");
    sportSpan.textContent = m.sport || "#sport#";
    sportSpan.style.fontWeight = "bold";
    sportSpan.style.minWidth = "50px";

    // Teams
    const teamSpan = document.createElement("span");
    teamSpan.textContent = m.title || "Team A vs Team B";
    teamSpan.style.flexGrow = "1";
    teamSpan.style.margin = "0 1rem";

    // Kickoff time from now
    const kickoff = new Date(m.date);
    const diffHours = ((kickoff - now)/3600000).toFixed(1);
    const timeSpan = document.createElement("span");
    timeSpan.textContent = diffHours + "h from now";

    // Optional LIVE badge
    if(now >= m.date && now <= m.date + 2*3600000) {
      const badge = document.createElement("span");
      badge.className = "live-badge";
      badge.textContent = "LIVE";
      timeSpan.appendChild(badge);
    }

    // Arrow
    const arrow = document.createElement("span");
    arrow.innerHTML = "&#8250;";
    arrow.style.color = "#ff6700"; // brand accent

    // Append elements
    a.appendChild(sportSpan);
    a.appendChild(teamSpan);
    a.appendChild(timeSpan);
    a.appendChild(arrow);

    matchesDiv.appendChild(a);
  });
}

// Load all matches today
async function loadTodayMatches() {
  const sports = await fetchSports();
  let allMatches = [];
  for(const sport of sports) {
    const matches = await fetchMatchesForSport(sport.id);
    allMatches = allMatches.concat(matches.map(m=>({...m, sport: sport.name})));
  }
  const todayMatches = filterToday(allMatches).sort((a,b)=>a.date-b.date);
  renderMatches(todayMatches);
}

// Run on page load
loadTodayMatches();
</script>

</body>
</html>
