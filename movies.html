<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Streaming Hub</title>
<style>
  :root {
    --primary: #e50914; /* Netflix Red */
    --bg: #141414;
    --surface: #1f1f1f;
    --text: #ffffff;
    --gray: #b3b3b3;
  }

  body {
    margin: 0;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    background-color: var(--bg);
    color: var(--text);
    overflow-x: hidden;
  }

  /* Navigation & Header */
  header {
    background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%);
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 1000;
    padding: 1rem 4%;
    display: flex;
    align-items: center;
    box-sizing: border-box;
    transition: background 0.3s;
  }

  .logo {
    color: var(--primary);
    font-size: 1.8rem;
    font-weight: bold;
    text-transform: uppercase;
    margin-right: 2rem;
    cursor: pointer;
  }

  .nav-links {
    display: flex;
    gap: 1.5rem;
    flex-grow: 1;
  }

  .nav-links span {
    cursor: pointer;
    font-size: 0.9rem;
    transition: color 0.3s;
  }

  .nav-links span:hover { color: var(--gray); }

  .search-box {
    background: rgba(0,0,0,0.6);
    border: 1px solid #fff;
    padding: 5px 10px;
    display: flex;
    align-items: center;
  }

  .search-box input {
    background: transparent;
    border: none;
    color: white;
    outline: none;
    padding-left: 5px;
  }

  /* Hero Section */
  .hero {
    height: 70vh;
    background-size: cover;
    background-position: center top;
    display: flex;
    align-items: center;
    padding: 0 4%;
    position: relative;
    margin-bottom: -50px;
  }

  .hero::after {
    content: '';
    position: absolute;
    bottom: 0; left: 0; width: 100%; height: 150px;
    background: linear-gradient(to top, var(--bg), transparent);
  }

  .hero-content {
    max-width: 600px;
    z-index: 2;
  }

  .hero-title { font-size: 3.5rem; margin: 0; font-weight: bold; }
  .hero-desc { font-size: 1.2rem; margin: 1rem 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }

  .btn-play {
    background: white;
    color: black;
    padding: 0.6rem 1.8rem;
    border: none;
    border-radius: 4px;
    font-weight: bold;
    font-size: 1.1rem;
    cursor: pointer;
    margin-right: 10px;
  }

  /* Genre Filter */
  .genre-bar {
    padding: 100px 4% 0;
    display: flex;
    gap: 10px;
    overflow-x: auto;
    white-space: nowrap;
    scrollbar-width: none;
  }
  .genre-bar::-webkit-scrollbar { display: none; }

  .genre-tag {
    background: var(--surface);
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    border: 1px solid transparent;
    transition: 0.3s;
  }

  .genre-tag:hover, .genre-tag.active {
    border-color: white;
    background: #333;
  }

  /* Carousel Section */
  .section {
    margin: 3rem 0;
    padding: 0 4%;
  }

  .section h3 {
    font-size: 1.4rem;
    margin-bottom: 0.8rem;
    font-weight: 500;
  }

  .carousel {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding: 10px 0;
    scrollbar-width: none;
  }

  .carousel::-webkit-scrollbar { display: none; }

  .card {
    flex: 0 0 200px;
    position: relative;
    transition: transform 0.4s ease;
    cursor: pointer;
    border-radius: 4px;
    overflow: hidden;
  }

  .card:hover {
    transform: scale(1.1);
    z-index: 10;
  }

  .poster {
    width: 100%;
    aspect-ratio: 16/9; /* Netflix style wide cards for lists */
    background-size: cover;
    background-position: center;
    border-radius: 4px;
  }

  .card-info {
    padding: 8px;
    font-size: 0.8rem;
    background: var(--surface);
  }
</style>
</head>
<body>

<header id="mainNav">
  <div class="logo" onclick="location.reload()">STREAM</div>
  <div class="nav-links">
    <span onclick="loadSection('popular')">Home</span>
    <span onclick="loadSection('trending')">Movies</span>
    <span onclick="loadRecent()">New & Popular</span>
  </div>
  <div class="search-box">
    <input id="search" placeholder="Titles, people, genres..." onkeypress="handleSearch(event)">
  </div>
</header>

<div id="hero" class="hero">
  <div class="hero-content">
    <h1 id="heroTitle" class="hero-title">Featured Movie</h1>
    <p id="heroDesc" class="hero-desc">Discover your next favorite story.</p>
    <button class="btn-play">▶ Play</button>
    <button class="btn-play" style="background: rgba(109, 109, 110, 0.7); color: white;">ⓘ More Info</button>
  </div>
</div>

<div class="genre-bar" id="genreBar">
  <div class="genre-tag active" onclick="filterByGenre(null, this)">All</div>
  </div>

<div class="section">
  <h3 id="rowTitle">Popular on Stream</h3>
  <div id="mainGrid" class="carousel"></div>
</div>

<div class="section">
  <h3>Trending Now</h3>
  <div id="trending" class="carousel"></div>
</div>

<script>
const API_KEY = "12955008668c12c07496b04132f9ce44";
const IMG = "https://image.tmdb.org/t/p/w1280"; // Higher res for Hero
const POSTER = "https://image.tmdb.org/t/p/w500";

// Fetch Genres
async function loadGenres() {
  const res = await fetch(`https://api.themoviedb.org/3/genre/movie/list?api_key=${API_KEY}`);
  const data = await res.json();
  const bar = document.getElementById('genreBar');
  data.genres.forEach(g => {
    const tag = document.createElement('div');
    tag.className = 'genre-tag';
    tag.innerText = g.name;
    tag.onclick = () => filterByGenre(g.id, tag);
    bar.appendChild(tag);
  });
}

// Netflix-style row rendering
function renderRow(list, containerId) {
  const container = document.getElementById(containerId);
  container.innerHTML = "";
  list.forEach(movie => {
    if (!movie.backdrop_path) return;

    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="poster" style="background-image: url(${POSTER}${movie.backdrop_path})"></div>
      <div class="card-info">
        <strong>${movie.title}</strong>
        <div style="color: #46d369; margin-top: 4px;">${Math.round(movie.vote_average * 10)}% Match</div>
      </div>
    `;

    card.onclick = async () => {
      const res = await fetch(`https://api.themoviedb.org/3/movie/${movie.id}?api_key=${API_KEY}`);
      const data = await res.json();
      location.href = `viewer.html?type=movie&imdb=${data.imdb_id}&title=${encodeURIComponent(movie.title)}`;
    };

    container.appendChild(card);
  });
}

// Update Hero Section
async function setHero() {
  const res = await fetch(`https://api.themoviedb.org/3/movie/upcoming?api_key=${API_KEY}`);
  const data = await res.json();
  const movie = data.results[0];
  document.getElementById('hero').style.backgroundImage = `linear-gradient(to right, rgba(0,0,0,0.8), transparent), url(${IMG}${movie.backdrop_path})`;
  document.getElementById('heroTitle').innerText = movie.title;
  document.getElementById('heroDesc').innerText = movie.overview.slice(0, 150) + "...";
}

async function filterByGenre(id, el) {
  document.querySelectorAll('.genre-tag').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  
  const url = id 
    ? `https://api.themoviedb.org/3/discover/movie?api_key=${API_KEY}&with_genres=${id}`
    : `https://api.themoviedb.org/3/movie/popular?api_key=${API_KEY}`;
    
  const res = await fetch(url);
  const data = await res.json();
  document.getElementById('rowTitle').innerText = id ? `Top ${el.innerText} Movies` : "Popular on Stream";
  renderRow(data.results, 'mainGrid');
}

function handleSearch(e) {
  if (e.key === 'Enter') {
    const q = e.target.value;
    fetch(`https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&query=${q}`)
      .then(res => res.json())
      .then(data => {
        document.getElementById('rowTitle').innerText = `Results for: ${q}`;
        renderRow(data.results, 'mainGrid');
        window.scrollTo({top: 400, behavior: 'smooth'});
      });
  }
}

// Initializing
setHero();
loadGenres();
filterByGenre(null, document.querySelector('.genre-tag'));

// Second row for variety
fetch(`https://api.themoviedb.org/3/trending/movie/week?api_key=${API_KEY}`)
  .then(res => res.json())
  .then(data => renderRow(data.results, 'trending'));

// Navbar transparency effect
window.onscroll = () => {
  const nav = document.getElementById('mainNav');
  if (window.scrollY > 50) nav.style.background = "#141414";
  else nav.style.background = "linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%)";
};
</script>

</body>
</html>
