<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Football Streams</title>

<style>
body {
  margin:0;
  font-family:'Segoe UI',Roboto,sans-serif;
  background: radial-gradient(circle at top, #1e1e1e, #0b0b0b);
  color:#fff;
}

.header {
  padding:1rem;
  text-align:center;
}

.controls {
  display:flex;
  justify-content:center;
  gap:.5rem;
  flex-wrap:wrap;
}

input {
  padding:.6rem 1rem;
  border-radius:.4rem;
  border:none;
  width:240px;
}

button {
  padding:.6rem 1.2rem;
  border:none;
  border-radius:.4rem;
  background:#ff6700;
  color:#000;
  font-weight:600;
  cursor:pointer;
}

button.active {
  background:#fff;
}

/* FORCE 2 COLUMNS */
.grid {
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:1rem;
  padding:1rem;
}

@media (min-width: 900px) {
  .grid { grid-template-columns: repeat(3, 1fr); }
}
@media (min-width: 1200px) {
  .grid { grid-template-columns: repeat(4, 1fr); }
}

/* CARD */
.card {
  background:#121212;
  border-radius:.7rem;
  overflow:hidden;
  cursor:pointer;
  transition:.2s;
  aspect-ratio: 9 / 16;
  display:flex;
  flex-direction:column;
}
.card:hover { transform:scale(1.04); }

/* TOP HALF */
.poster {
  flex:1;
  background-size:cover;
  background-position:center;
  position:relative;
}

/* STATUS DOT */
.badge {
  position:absolute;
  top:.5rem;
  right:.5rem;
  width:12px;
  height:12px;
  border-radius:50%;
  border:2px solid #fff;
}
.badge.live { background:red; }
.badge.soon { background:orange; }

/* BOTTOM HALF */
.info {
  flex:1;
  padding:.6rem;
  display:flex;
  flex-direction:column;
  justify-content:center;
  text-align:center;
  background:#181818;
}

.teams {
  font-weight:600;
  font-size:.95rem;
  line-height:1.2;
}

.time {
  margin-top:.4rem;
  font-size:.85rem;
  opacity:.75;
}
</style>
</head>

<body>

<div class="header">
  <h2>Football Streams</h2>
  <div class="controls">
    <input id="search" placeholder="Search matchesâ€¦">
    <br>
    <button id="liveBtn">Live</button>
    <button id="soonBtn">Starting Soon</button>
    <button id="popularBtn">Popular</button>
  </div>
</div>

<div id="grid" class="grid"></div>

<script>
const grid = document.getElementById("grid");
const searchInput = document.getElementById("search");
const liveBtn = document.getElementById("liveBtn");
const soonBtn = document.getElementById("soonBtn");
const popularBtn = document.getElementById("popularBtn");

let allMatches = [];
let liveMode = false;
let soonMode = false;
let popularMode = false;

async function fetchMatches() {
  const urls = [];
  if (popularMode) urls.push("https://streamed.pk/api/matches/football/popular");
  if (liveMode) urls.push("https://streamed.pk/api/matches/live");
  if (!urls.length) urls.push("https://streamed.pk/api/matches/football");

  const data = await Promise.all(urls.map(u => fetch(u).then(r => r.json())));
  allMatches = data.flat().filter(m => m.category === "football");
  render();
}

function render() {
  grid.innerHTML = "";
  const now = Date.now();
  const q = searchInput.value.toLowerCase();

  let list = allMatches.filter(m => m.title.toLowerCase().includes(q));

  if (soonMode) {
    list = list.filter(m => m.date > now && m.date - now <= 3600000);
  }

  list.forEach(m => {
    if (!m.poster || !m.sources?.length) return;

    const card = document.createElement("div");
    card.className = "card";

    const poster = document.createElement("div");
    poster.className = "poster";
    poster.style.backgroundImage = `url(https://streamed.pk${m.poster})`;

    const matchDuration = 2 * 60 * 60 * 1000;
    const diff = m.date - now;

    const badge = document.createElement("div");
    badge.className = "badge";

    if (now >= m.date && now <= m.date + matchDuration) {
      badge.classList.add("live");
      poster.appendChild(badge);
    } else if (diff > 0 && diff <= 3600000) {
      badge.classList.add("soon");
      poster.appendChild(badge);
    }

    const info = document.createElement("div");
    info.className = "info";

    let teams = m.title;
    if (m.teams?.home && m.teams?.away) {
      teams = `${m.teams.home.name} vs ${m.teams.away.name}`;
    }

    const teamsDiv = document.createElement("div");
    teamsDiv.className = "teams";
    teamsDiv.textContent = teams;

    const timeDiv = document.createElement("div");
    timeDiv.className = "time";
    timeDiv.textContent =
      now >= m.date && now <= m.date + matchDuration
        ? "LIVE"
        : diff > 0 && diff <= 3600000
        ? `${Math.floor(diff / 60000)}m until kick-off`
        : new Date(m.date).toLocaleTimeString([], {hour:"2-digit", minute:"2-digit"});

    info.appendChild(teamsDiv);
    info.appendChild(timeDiv);

    card.appendChild(poster);
    card.appendChild(info);

    const s = m.sources[0];
    card.onclick = () => {
      location.href =
        `viewer.html?type=football&source=${s.source}&id=${s.id}&title=${encodeURIComponent(teams)}`;
    };

    grid.appendChild(card);
  });
}

liveBtn.onclick = () => {
  liveMode = !liveMode;
  liveBtn.classList.toggle("active", liveMode);
  fetchMatches();
};

popularBtn.onclick = () => {
  popularMode = !popularMode;
  popularBtn.classList.toggle("active", popularMode);
  fetchMatches();
};

soonBtn.onclick = () => {
  soonMode = !soonMode;
  soonBtn.classList.toggle("active", soonMode);
  render();
};

searchInput.oninput = render;

fetchMatches();
</script>

</body>
</html>
