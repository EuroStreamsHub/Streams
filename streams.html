<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Football Streams</title>
<style>
body {
  margin:0;
  font-family:'Segoe UI',Roboto,sans-serif;
  background: radial-gradient(circle at top, #1e1e1e, #0b0b0b);
  color:#fff;
}

/* HEADER */
.header {
  padding:1rem;
  text-align:center;
}

/* SOURCES */
.source-row {
  display:flex;
  justify-content:center;
  gap:0.5rem;
  margin-bottom:1rem;
}
.source-row button {
  padding:.5rem 1rem;
  border:none;
  border-radius:.4rem;
  background:#ff6700;
  color:#000;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}
.source-row button.active {
  background:#fff;
  color:#000;
}

/* SEARCH */
.controls {
  display:flex;
  justify-content:center;
  margin-bottom:0.5rem;
}
.controls input {
  padding:.6rem 1rem;
  border-radius:.4rem;
  border:none;
  width:240px;
  max-width:90%;
  margin-bottom:0.5rem;
}

/* FILTER BUTTONS */
.filter-row {
  display:flex;
  justify-content:center;
  gap:.5rem;
  margin-bottom:1rem;
}
.filter-row button {
  padding:.5rem 1rem;
  border:none;
  border-radius:.4rem;
  background:#ff6700;
  color:#000;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}
.filter-row button.active {
  background:#fff;
  color:#000;
}

/* GRID */
.grid {
  display:grid;
  grid-template-columns:1fr;
  gap:0.5rem;
  padding:0 1rem 1rem 1rem;
}
@media (min-width:700px){ .grid { grid-template-columns:1fr 1fr; } }

/* CARD (horizontal bar) */
.card {
  background:#121212;
  border-radius:.5rem;
  padding:.6rem 1rem;
  cursor:pointer;
  display:flex;
  justify-content:space-between;
  align-items:center;
  transition:.2s;
}
.card:hover { background:#1f1f1f; }

/* TEAM TEXT */
.teams { font-weight:600; }
.time { opacity:.75; font-size:.85rem; }
</style>
</head>
<body>

<div class="header">
  <h2>Football Streams</h2>

  <!-- Sources -->
  <div class="source-row">
    <button id="source1" class="active">Source 1</button>
    <button id="source2">Source 2</button>
  </div>

  <!-- Search -->
  <div class="controls">
    <input id="search" placeholder="Search matchesâ€¦">
  </div>

  <!-- Filters -->
  <div class="filter-row">
    <button id="liveBtn">Live</button>
    <button id="soonBtn">Starting Soon</button>
  </div>
</div>

<div id="grid" class="grid"></div>

<script>
const grid = document.getElementById("grid");
const searchInput = document.getElementById("search");
const liveBtn = document.getElementById("liveBtn");
const soonBtn = document.getElementById("soonBtn");
const source1Btn = document.getElementById("source1");
const source2Btn = document.getElementById("source2");

let allMatches = [];
let liveMode = false, soonMode = false;
let source = 1; // default source 1

/* FETCH MATCHES */
async function fetchMatches() {
  let url;
  if(source === 1){
    url = "https://streamed.pk/api/matches/football";
  } else {
    url = "https://beta.adstrim.ru/api/events";
  }

  const res = await fetch(url);
  let data = await res.json();

  if(source === 1){
    allMatches = data.filter(m => m.category==="football");
  } else {
    allMatches = data.data.map(m => ({
      id: m.id,
      home_team: m.home_team,
      away_team: m.away_team,
      date: m.timestamp * 1000,
      channels: m.channels
    }));
  }

  render();
}

/* RENDER GRID */
function render() {
  grid.innerHTML = "";
  const now = Date.now();
  const q = searchInput.value.toLowerCase();

  let list = allMatches.filter(m => {
    const teams = source===1 ? m.title : `${m.home_team} vs ${m.away_team}`;
    return teams.toLowerCase().includes(q);
  });

  if(soonBtn.classList.contains("active")){
    list = list.filter(m => m.date > now && m.date - now <= 3600000);
  }
  if(liveBtn.classList.contains("active")){
    list = list.filter(m => m.date <= now && m.date + 2*60*60*1000 >= now);
  }

  list.forEach(m=>{
    const card = document.createElement("div");
    card.className = "card";

    let teams = source===1 ? m.title : `${m.home_team} vs ${m.away_team}`;
    let diff = m.date - now;
    let timeText = diff>0 ? `${Math.floor(diff/60000)}m until kick-off` : "LIVE";

    const teamsDiv = document.createElement("div");
    teamsDiv.className="teams";
    teamsDiv.textContent = teams;

    const timeDiv = document.createElement("div");
    timeDiv.className="time";
    timeDiv.textContent = timeText;

    card.appendChild(teamsDiv);
    card.appendChild(timeDiv);

    card.onclick = ()=>{
      let channel = source===1 ? m.sources?.[0]?.source : m.channels?.[0]?.link;
      location.href=`viewer.html?type=football&source=${source}&id=${m.id}&channel=${channel}&title=${encodeURIComponent(teams)}`;
    };

    grid.appendChild(card);
  });
}

/* BUTTON HANDLERS */
liveBtn.onclick = ()=>{
  liveMode = !liveMode;
  liveBtn.classList.toggle("active", liveMode);
  render();
};
soonBtn.onclick = ()=>{
  soonMode = !soonMode;
  soonBtn.classList.toggle("active", soonMode);
  render();
};
searchInput.oninput = render;

source1Btn.onclick = ()=>{
  source = 1;
  source1Btn.classList.add("active");
  source2Btn.classList.remove("active");
  fetchMatches();
};
source2Btn.onclick = ()=>{
  source = 2;
  source2Btn.classList.add("active");
  source1Btn.classList.remove("active");
  fetchMatches();
};

// Initial load
fetchMatches();
</script>
</body>
</html>
