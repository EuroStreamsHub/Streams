<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Streams | Source 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg:#0f1014;
  --surface:#1a1c22;
  --border:#2a2d35;
  --primary:#0072db;
  --live:#e50914;
  --text:#fff;
}
body {
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,sans-serif;
  padding-top:80px;
}
header {
  position:fixed;
  inset:0 0 auto 0;
  height:80px;
  display:flex;
  align-items:center;
  gap:16px;
  padding:0 4%;
  background:#0f1014f2;
  border-bottom:1px solid var(--border);
}
.logo { font-weight:900; color:var(--primary); cursor:pointer; }
.search input {
  background:#252830;
  border:1px solid #3f434e;
  color:white;
  padding:10px 14px;
  border-radius:6px;
}
.source-switch a {
  padding:8px 14px;
  border-radius:999px;
  text-decoration:none;
  font-weight:800;
  border:1px solid #3f434e;
  color:#9ca3af;
}
.source-switch .active {
  background:var(--primary);
  color:white;
  border-color:var(--primary);
}
.filters {
  padding:1.2rem 4%;
  display:flex;
  gap:10px;
}
.filter-btn {
  background:var(--surface);
  border:1px solid var(--border);
  padding:8px 18px;
  border-radius:999px;
  cursor:pointer;
}
.filter-btn.active {
  background:var(--live);
  border-color:var(--live);
}
.grid {
  padding:1rem 4%;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
  gap:1.2rem;
}
.card {
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:12px;
  padding:1.2rem;
  cursor:pointer;
}
.live { color:var(--live); font-weight:900; }
</style>
</head>

<body>

<header>
  <div class="logo" onclick="location.href='index.html'">SPORT HUB</div>
  <div class="search"><input id="search" placeholder="Search teams"></div>

  <div class="source-switch">
    <a href="streams.html" class="active">Source 1</a>
    <a href="streams2.html">Source 2</a>
  </div>
</header>

<div class="filters">
  <button class="filter-btn" onclick="setMode('live',this)">Live</button>
  <button class="filter-btn" onclick="setMode('soon',this)">Soon</button>
</div>

<div class="grid" id="grid">Loadingâ€¦</div>

<script>
let matches=[], mode="all";
const NOW=()=>Math.floor(Date.now()/1000);

async function load(){
  const r=await fetch("https://beta.adstrim.ru/api/events");
  matches=(await r.json()).data;
  render();
}
function setMode(m,el){
  document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
  if(mode===m){mode="all";return render();}
  el.classList.add('active');mode=m;render();
}
function render(){
  const q=document.getElementById("search").value.toLowerCase();
  let out=matches.filter(m=>`${m.home_team} ${m.away_team}`.toLowerCase().includes(q));
  out=out.filter(m=>{
    const live=NOW()>=m.timestamp-300 && NOW()<=m.timestamp+7200;
    const soon=m.timestamp>NOW() && m.timestamp<=NOW()+3600;
    if(mode==="live") return live;
    if(mode==="soon") return soon;
    return true;
  });
  const g=document.getElementById("grid");
  g.innerHTML="";
  out.forEach(m=>{
    const live=NOW()>=m.timestamp-300 && NOW()<=m.timestamp+7200;
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`<b>${m.home_team} vs ${m.away_team}</b><br>${live?'<span class="live">LIVE</span>':''}`;
    c.onclick=()=>{
      location.href=`streamviewer2.html?title=${encodeURIComponent(m.home_team+" vs "+m.away_team)}&legacy=1`;
    };
    g.appendChild(c);
  });
}
document.getElementById("search").oninput=render;
load();
</script>
</body>
</html>
