<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Football Stream Viewer</title>
<style>
body {
  background:#121212;
  color:#f1faee;
  font-family:'Segoe UI',Roboto,sans-serif;
  padding:1rem;
  text-align:center;
}
.back-button {
  display:inline-block;
  margin:0.5rem auto 1rem auto;
  padding:.6rem 1rem;
  background:#e63946;
  color:#f1faee;
  border:none;
  border-radius:.5rem;
  font-weight:600;
  cursor:pointer;
  text-decoration:none;
  transition:.2s;
}
.back-button:hover { filter:brightness(1.2); }
h2 {
  margin-bottom:.5rem;
}
.description {
  font-size:0.95rem;
  color:#ccc;
  margin-bottom:1rem;
}
.source-buttons {
  display:flex;
  gap:.3rem;
  flex-wrap:wrap;
  justify-content:center;
  margin-bottom:1rem;
}
.button {
  background:#1f1f1f;
  color:#f1faee;
  padding:.5rem .9rem;
  border:none;
  border-radius:.5rem;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}
.button:hover { filter:brightness(1.2); }
.stream-container {
  width:90%;
  max-width:1200px;
  aspect-ratio:16/9;
  background:#000;
  margin:0 auto;
  position:relative;
}
iframe {
  width:100%;
  height:100%;
  border:none;
}
.loader {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  border:6px solid rgba(255,255,255,0.1);
  border-top:6px solid #e63946;
  border-radius:50%;
  width:50px;
  height:50px;
  animation:spin 1s linear infinite;
  display:none;
  z-index:5;
}
@keyframes spin {0%{transform:translate(-50%,-50%) rotate(0deg);}100%{transform:translate(-50%,-50%) rotate(360deg);}}
</style>
</head>
<body>

<a href="index.html" class="back-button">⬅ Back to Matches</a>

<h2 id="match-title">Loading...</h2>
<div class="description" id="match-description"></div>

<div class="source-buttons" id="source-buttons"></div>
<div class="stream-container">
  <div class="loader" id="loader"></div>
  <iframe id="stream-iframe" allowfullscreen sandbox="allow-scripts allow-same-origin allow-popups allow-top-navigation"></iframe>
</div>

<script>
const API_BASE="https://streamed.pk/api";
const iframe = document.getElementById("stream-iframe");
const loader = document.getElementById("loader");
const sourceButtons = document.getElementById("source-buttons");
const matchTitle = document.getElementById("match-title");
const matchDescription = document.getElementById("match-description");

// Get match object from URL
const urlParams = new URLSearchParams(window.location.search);
const matchParam = urlParams.get("match");
const match = matchParam ? JSON.parse(decodeURIComponent(matchParam)) : null;

if(!match){
  matchTitle.textContent = "No match selected";
}else{
  matchTitle.textContent = match.title || ((match.teams?.home?.name || "TBD") + " vs " + (match.teams?.away?.name || "TBD"));

  // Kickoff info + description
  const ko = match.date ? new Date(match.date).toLocaleString([], {weekday:'short', day:'numeric', month:'short', hour:'2-digit', minute:'2-digit'}) : "TBD";
  matchDescription.textContent = `Kick-off: ${ko}${match.description ? " — " + match.description : ""}`;

  const sources = match.sources || [];
  if(sources.length === 0){
    matchDescription.textContent += " (No streams available)";
  } else {
    sources.slice(0,6).forEach((s,i)=>{
      const btn = document.createElement("button");
      btn.className = "button";
      btn.textContent = i+1;
      btn.onclick = () => loadStream(s);
      sourceButtons.appendChild(btn);
    });

    // Load first source by default
    loadStream(sources[0]);
  }
}

function loadStream(src){
  loader.style.display = "block";
  fetch(`${API_BASE}/stream/${src.source}/${src.id}`)
    .then(res => res.json())
    .then(arr => {
      iframe.src = arr[0]?.embedUrl || "";
    })
    .catch(err=>{
      console.error(err);
      iframe.src = "";
    })
    .finally(()=>{ loader.style.display = "none"; });
}
</script>

</body>
</html>.source-buttons {
  display:flex;
  gap:.3rem;
  flex-wrap:wrap;
  justify-content:center;
  margin-bottom:1rem;
}
.button {
  background:#1f1f1f;
  color:#f1faee;
  padding:.5rem .9rem;
  border:none;
  border-radius:.5rem;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}
.button:hover { filter:brightness(1.2); }
.stream-container {
  width:90%;
  max-width:1200px;
  aspect-ratio:16/9;
  background:#000;
  margin:0 auto;
  position:relative;
}
iframe {
  width:100%;
  height:100%;
  border:none;
}
.loader {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  border:6px solid rgba(255,255,255,0.1);
  border-top:6px solid #e63946;
  border-radius:50%;
  width:50px;
  height:50px;
  animation:spin 1s linear infinite;
  display:none;
  z-index:5;
}
@keyframes spin {0%{transform:translate(-50%,-50%) rotate(0deg);}100%{transform:translate(-50%,-50%) rotate(360deg);}}
</style>
</head>
<body>

<a href="index.html" class="back-button">⬅ Back to Matches</a>

<h2 id="match-title">Loading...</h2>
<div class="description" id="match-description"></div>

<div class="source-buttons" id="source-buttons"></div>
<div class="stream-container">
  <div class="loader" id="loader"></div>
  <iframe id="stream-iframe" allowfullscreen sandbox="allow-scripts allow-same-origin allow-popups allow-top-navigation"></iframe>
</div>

<script>
const API_BASE="https://streamed.pk/api";
const iframe = document.getElementById("stream-iframe");
const loader = document.getElementById("loader");
const sourceButtons = document.getElementById("source-buttons");
const matchTitle = document.getElementById("match-title");
const matchDescription = document.getElementById("match-description");

// Get match object from URL
const urlParams = new URLSearchParams(window.location.search);
const matchParam = urlParams.get("match");
const match = matchParam ? JSON.parse(decodeURIComponent(matchParam)) : null;

if(!match){
  matchTitle.textContent = "No match selected";
}else{
  matchTitle.textContent = match.title || ((match.teams?.home?.name || "TBD") + " vs " + (match.teams?.away?.name || "TBD"));

  // Kickoff info + description
  const ko = match.date ? new Date(match.date).toLocaleString([], {weekday:'short', day:'numeric', month:'short', hour:'2-digit', minute:'2-digit'}) : "TBD";
  matchDescription.textContent = `Kick-off: ${ko}${match.description ? " — " + match.description : ""}`;

  const sources = match.sources || [];
  if(sources.length === 0){
    matchDescription.textContent += " (No streams available)";
  } else {
    sources.slice(0,6).forEach((s,i)=>{
      const btn = document.createElement("button");
      btn.className = "button";
      btn.textContent = i+1;
      btn.onclick = () => loadStream(s);
      sourceButtons.appendChild(btn);
    });

    // Load first source by default
    loadStream(sources[0]);
  }
}

function loadStream(src){
  loader.style.display = "block";
  fetch(`${API_BASE}/stream/${src.source}/${src.id}`)
    .then(res => res.json())
    .then(arr => {
      iframe.src = arr[0]?.embedUrl || "";
    })
    .catch(err=>{
      console.error(err);
      iframe.src = "";
    })
    .finally(()=>{ loader.style.display = "none"; });
}
</script>

</body>
</html>
<h2 id="match-title">Loading...</h2>
<div class="description" id="match-description"></div>

<div class="source-buttons" id="source-buttons"></div>
<div class="stream-container">
  <div class="loader" id="loader"></div>
  <iframe id="stream-iframe" allowfullscreen sandbox="allow-scripts allow-same-origin allow-popups allow-top-navigation"></iframe>
</div>

<script>
const API_BASE="https://streamed.pk/api";
const iframe=document.getElementById("stream-iframe");
const loader=document.getElementById("loader");
const sourceButtons=document.getElementById("source-buttons");
const matchTitle=document.getElementById("match-title");
const matchDescription=document.getElementById("match-description");

const urlParams=new URLSearchParams(window.location.search);
const matchParam=urlParams.get("match");
const match=matchParam ? JSON.parse(decodeURIComponent(matchParam)) : null;

if(!match){
  matchTitle.textContent="No match selected";
}else{
  // Title
  matchTitle.textContent = match.title || 
    ((match.teams?.home?.name || "TBD") + " vs " + (match.teams?.away?.name || "TBD"));

  // Kickoff info + description
  const ko = match.date ? new Date(match.date).toLocaleString([], {weekday:'short', day:'numeric', month:'short', hour:'2-digit', minute:'2-digit'}) : "TBD";
  matchDescription.textContent = `Kick-off: ${ko}${match.description ? " — " + match.description : ""}`;

  const sources = match.sources || [];
  if(sources.length === 0){
    matchDescription.textContent += " (No streams available)";
  } else {
    sources.slice(0,6).forEach((s,i)=>{
      const btn = document.createElement("button");
      btn.className = "button";
      btn.textContent = i + 1;
      btn.onclick = () => loadStream(s);
      sourceButtons.appendChild(btn);
    });
    loadStream(sources[0]);
  }
}

function loadStream(src){
  loader.style.display = "block";
  fetch(`${API_BASE}/stream/${src.source}/${src.id}`)
    .then(res => res.json())
    .then(arr => {
      iframe.src = arr[0]?.embedUrl || "";
    })
    .catch(err=>{
      console.error(err);
      iframe.src = "";
    })
    .finally(()=>{ loader.style.display = "none"; });
}
</script>

</body>
</html>
